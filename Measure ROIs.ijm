// Measure ROIs Macro Toolset by Christophe Leterrier
// 28/02/2017


// gets the path to the "added macros" folder in ImageJ plugins folder
//var MACRO_PATH = getDirectory("plugins") + "NeuroCyto Lab" + File.separator;

// Tool 14

macro "Generate Tracings Folder Action Tool - C000D0fC2bfDddCf88D78CfeaD33Dc3Ce43D77CfeaD44D54D64D74D84D94Da4Db4Cfc8DaeDceCc32D88Cfe9D37Cec7D5dD6dD7dD8dD9dCffbD31Dc1Cdb6D27Dd7CfeaD34D35D42D43D52D53D62D63D72D73D82D83D92D93Da2Da3Db2Db3Dc4Dc5Dc6Cfd9D38D39D47D48D57D97D98Da7Da8Da9Dc9Ca84D3fD4fD5fD6fD7fD8fD9fDafDbfDcfCfd9D46D56D66D76D86D96Da6Db6Cec7D21D22D30D40D50D60D70D80D90Da0Db0Dc0Dd1Dd2CffaD32D41D51D61D71D81D91Da1Db1Dc2Ccb5D4dCfe7D2dD3cD4bD5aCca2D3bD4aCfecDe7Cec8D4eD5eD6eD7bD7eD8bD8eD9bD9eDadDcdCffdD1eCcb7D0eCa92D3dD4cD5bCed9D20Dd0Cea7D67Cca6DbaDbbDebCfd8D99DaaDabDcaDcbCb91D2cCfe9D36D45D55D65D75D85D95Da5Db5Db7Cec7D6cD7cD8cD9cCec6D3aD49CeeeDffCca6Db9Cc95DbcDedCfffD69DfeCdc7Dc7C973D2eD6aD79CccbDeeDefCea7D87Cca5D2bDecCed8D8aD9aDacDccCb85D68DbeCdb7D24D25D26Dd4Dd5Dd6Cdb6D3eD6bCcb4D1dCfedD0dCdb7Db8Dc8C985D2fDdfCeedD1cDdaDdbCeb7D23Dd3Cda6D2aDeaCb94DbdDdeCdb6D28D29De8De9Cba7D59D7aCfffDd9Cdc8D58C874D1fC4cfDdcCd96D89Cdb5D5c"{

	run("Generate Tracings Folder");

} 

// Tool 15
macro "Launch NeuronJ Action Tool - C000D0fCf55De2Cd44De1CfccDe0Cc44Df2Cfe8Da5CcbaD4eCfffD8eD9eDaeDb3DbeDc2DcfDdfCa93D89Cfe7D96Cec5Da6CeeeD8fD9fDa2Ccb5D2bCfe8D3bD4aD59D68D77D86D95Da4CdddD4fD5fDd5Ca44De3Ced6D69Cdc5Db5CfecD1eD2cD2dCcb4D3aD49D58D67D76D85D94CddbD7bCa96D1fD3eCeebD2aD39D48D57D66D75D84D93Db7Dc6Ced6D5aD79D88CeeeD5eD6eD7eDafDb1DbfCba7D0eCdddD6fD7fDc4Dd3C983D5cCf66Dd2Cd66Dc1CedcD0dCba3Da7CddbD5dD6cCba3D98Ced5D4bD5bD6aD97Cbb6Da3CdddDe4C983D6bCedbD8aD99Da8Ccb8D1dCfedD1bCcccD3fDc3Cba7D2eCbbbDb2Ce66Dd0CeccDf3Cba3Db4CddaD3dC983D4dCed7D78Cdc5D4cC888Dd4Cf88Dd1Ccb4D3cCfddDc0Cca4Db6Cba5Dc5Ca93D7aCdc9D1cCba9D2fCfe7D87CebbDf1"{

	run("NeuronJ");
}

// Tool 16
macro "Convert NDF to ROI Action Tool - C79cDdeCeeeDadDaeDbdDbeCbceD13D25Db8DeeCeefD46CacdDdbCeeeD6dD6eD7dD7eD8dD8eD9dD9eCcdeD26D66D68D86D88Dc8CeffDcbCaceD01D12D21CdefD24CbdeD36DdaCfffD3dD3eD4dD4eD5dD5eCbceD47Da7Dc9CeefD15Da8Dd9CfffD35Db9C9bdD67D76D78D87CdefD00D02D20D22D37Db7DcaCaceD10D57D97CfffD23CcdeD14DccDecC8adDdcCbcdDceC7acDcdDed"{

	run("Convert ndf to ROI");

}

// Tool 17

var Cmds = newMenu("Add ROI Menu Tool", newArray("Add category 0","Add category 1","Add category 2","Add category 3","Add category 4","Add category 5", "Add category 6", "Add category 7"));

macro "Add ROI Menu Tool - C8a6D57D75CfffDabCcccD04D05D06D07D23D32D34D43D44D50D60D70D71D81D82CbbbD5cD6cD6dD7dD9eDadDbcDcbDd6DdaDe7De8De9CdddD94D9dDa5DacDb6DbbDc7DcaDd9Cab8D87D98D99CdddD00D01D02D03D10D20D30D40Dd8CbdaDb8CeeeD46D64C9b7D66D9bCbbbD3aD4aD4bD5bDb4Dc5Dc6Dd7CeeeD22D24D42D49D5aD61D6bD72D7cD83D8dCaaaD7eD8eD8fD9fDaeDbdDccDdbDeaDf8Df9CdecD47D8bCcccD17D18D28D29D39D92D93Da3Da4Db5CfffD45D53D54DbaC9b7D65D86D97D9aDa9Db9Cac8D77D88CcdaD74D85D96Da7CeeeD16D27D38C9b8D67D76D78D89DaaCdecD58D69D7aC8b6D56D68D79D8aDa8CefeD55" {
	cmd = getArgument();
	if (cmd == "Add category 0") {
		addROI(0);	
	}

	if (cmd == "Add category 1") {
		addROI(1);
	}

	if (cmd == "Add category 2") {
		addROI(2);
	}			

	if (cmd == "Add category 3") {
		addROI(3);
	}	

	if (cmd == "Add category 4") {
		addROI(4);
	}	

	if (cmd == "Add category 5") {
		addROI(5);
	}	

	if (cmd == "Add category 6") {
		addROI(6);
	}

	if (cmd == "Add category 7") {
		addROI(7);
	}

}

	macro "Cat0 Shortcut [0]" {
		addROI(0);
	}
	macro "Cat1 Shortcut [1]" {
		addROI(1);
	}
	macro "Cat0 Shortcut [2]" {
		addROI(2);
	}
	macro "Cat0 Shortcut [3]" {
		addROI(3);
	}
	macro "Cat0 Shortcut [4]" {
		addROI(4);
	macro "Cat0 Shortcut [5]" {
		addROI(5);
	}
	macro "Cat0 Shortcut [6]" {
		addROI(6);
	}
	macro "Cat0 Shortcut [7]" {
		addROI(7);
	}

	function addROI(CAT) {
			CatColors = newArray("magenta","red","blue","red","blue","yellow","red","green");
			roiManager("add");
			i = (roiManager("count")-1);
			roiManager("select",i);
			SelectionName = call("ij.plugin.frame.RoiManager.getName",i);
			roiManager("select", i);
			roiManager("Set Color", CatColors[CAT]);
			// shift category by 8 to put NeuronJ categories first
			roiManager("Rename", SelectionName + "-" + (CAT + 8) + "-Cat"+ CAT);
			Roi.setProperty("TracingType", CAT);
			Roi.setProperty("TypeName", "Cat" + CAT);	
	}


// Tool 18
macro "Modify ROIs Action Tool -  Ca33D32D42D52D62D72D82D92Da2Db2Cc33D30D40D50D60D70D80D90Da0Db0C68eD24D44D64D84Da4Dc4C24bD08De8Cf77D31CccfD15D16D17D18D19D25D29D35D39D45D49D55D59D65D69D75D79D85D89D95D99Da5Da9Db5Db9Dc5Dc9Dd5Dd6Dd7Dd8Dd9C6a3D2dDcdCe34Da1CabeD07De7C38dD27Dc7CeeeD0eD1fDdfDeeCb33D21Dc1C68eD0aDeaC47cD38D48D58D68D78D88D98Da8Db8CeeeD2fD3fD4fD5fD6fD7fD8fD9fDafDbfDcfC9c5D7dCf67D41D51D61D71CabfD14D34D54D74D94Db4Dd4De5C39dD36D46D56D66D76D86D96Da6Db6CfffD0fDefC593D3eD4eD5eD6eD7eD8eD9eDaeDbeC5aeD97Da7C35eD2aD4aD6aD8aDaaDcaCdddD1eDdeC695D2eDceCd66D20Dc0CabfD05D1aD3aD5aD7aD9aDbaDdaC9c6D2cDccC6afD47D57Cc66D22Dc2C9d5DadC5aeD77D87C35bD06De6C7b3D3cD4cD5cD6cD7cD8cD9cDacDbcCe44D91CabfD09De9C69dD28Dc8C8aeD04De4C9c5D6dC6aeD26Dc6Ce56D81Cad6D5dC6bfD37C9d5DbdC9d5D8dD9dC5aeDb7Cf55Db1C5aeD67Cad7D4dCbe7D3d"{

	run("Edit Cat ROIs");

}

// Tool 19
macro "Lauch ProFeatFit Action Tool - C24aD77D87D97CeeeD2fD3fD4fD5fD6fD7fD8fD9fDafDbfDcfDdfCbceD44Db4CacdD0dD43Db3DfdCeefD2cD3cD4cD62D71D73CdefD5cD6bD6dD7bD7dD82D83D8bD8dD91D9bD9dDabDadDbbDbdDcbDcdDdbDddDecC9bdD1eD2eD3eD4eD54D5eD64D6eD74D7eD84D8eD94D9eDa4DaeDbeDceDdeDeeCdefD1bD51D72D81CdeeD0aD40Db0DfaCbceD0bD1aD2aD3aD41D4aD50D5aD60D6aD70D7aD80D8aD90D9aDa0DaaDb1DbaDcaDdaDeaDfbCfffD0fDffCdefD1dD53D5bD5dC57dD27CcdfDd6Dd8CaceD0cD42Db2DfcCeffD1cD2bD2dD3bD3dD4bD4dD52D61D63CeeeD1fDefCddfD26D28C35cDc6Dc8CcdeD6cD7cD8cD93D9cDa1Da2DacDbcDccDdcDebDedCacdDfeC67dD37C24bDa7CcdeDa3C46eDf0Df2Df4Df6Df8C36cD47CbcdD0eC68eD00D02D04D06D08C35dDd7C24bDb7CcdeD92C46dD36D38Dc7C24bD67C35bD57"{

	run("Pro Feat Fit");

}


// Tool 20
macro "Measure Intensities Action Tool - C000D7fCbbbDc9Ce55De7Cc33Df8CdddD6eCeb8D3bD3dD48Cb84D15D65D75D85D95Da5Db5Dc5Dd5De5CebbDf9Ceb7D4bCcb4D8dD9cDabDbaCeeeD0fD4fD5fD6fCeb9D02D20D50Df2Cb62D25D55CdccDdbCda7D36Cc96D04D58Df4CfedD7dCec8D45Cb85D5cCeecD8cD9bDaaDb9Ceb8D32D49D4aD4dD64D74D84D94Da4Db4Dc4Dd4Cba7D7eCfffDbeDd9Cfd9D33D63D83Da3Dc3Ca63D3eD4eCddbD9fDbdCda7D12D21D30D38D40D51D62D82Da2Dc2De2Cd94D23D53CeeeD0eD1fD2fD3fDc8Ceb8D14D39D46D47De4Cb94DadDbcDcbCfdaD31Cd96D56Cfc9D42D43Ca83D2dD5dD9eCcccD1eCdb7D34D73D93Db3Dd3Cc96D27D57D72D92Db2Dd2CffdD8eCfe7D9dDacDbbDcaCb85D28Cb99Dd8CfdaD13D41De3C987D2eDdaCccbDaeCe97D3aDe8Cc84D2bD54D5bCeddDd7CfbbDf7Cb73D22D24Cea7D4cCfc9D37D44Cca7D05Df5C976D2cDe9Cc85D26D29D59CedbDccCda6D03D3cDf3Cfc9D35Ca75D2aD5eCdddDeaC985D8fCc83D52Cc95D5a"{

	run("Measure Intensities");
}

// Tool 21
macro "Calculate Ratios Action Tool - C232D78D88C18cD65D66Ca00D3bD3cD3dCedaDa3C591DcbDccCccbD1cD2aDdaDecCa98D0cDfcCeeeD2fD3fD4fD5fD6fD7fD8fD9fDafDbfDcfDdfC386D9bD9cC4acD62D76D92Cc22D36D56De0Df1CeddD19Dc1De9C8b3D86Db8Db9DbdCddcD16D24D2bD2dD34D44D54DdbDddDe6Cba9D07D08Df7Df8CeeeD1fDefC863D3eD4eD5eD97Dc4C2adD7bD7cD7dD89D8dCd01D59D5aD5bD5cCedcD29Dd9C991D95Da4Da6Db6CdcbD28Dd8Ca98D09D0aD0bDc2Df9DfaDfbCfedD13D87C876D1eD2eDdeDeeCcbaD01D10D20D2cD30D40D50D60D70D80D90Da0Db0Dc0DdcCb86D0dD47D57Db5DfdCfedD15D23D33D43D53De5C6b5D99D9aDa8Da9DaaCcb9Db2Dd4CfffDd2C483D98D9dDcdC29cD72D82D8aD8bD8cCc00D37D38D39D46CedcD14D22D32D42D52Da2De4C6a2Dc5Dc6Dc7Dc8CccbD1aDe3DeaCed6D96Da5Db3Db4Dc3C768D6aD6bD6cD6dC7cdD02D73D83Ce23D48D49D4aD4bCeedD17D25D35D45D55Dd5De7C8c4DabDacDadDb7Cca9D06Df0Df6CffeD11C766D6eD9eDe2C3aeD74D75D79D7aD84Cd12D4cD4dD58D5dCedcD12D1bD1dD27Dd7DebDedC7b3Da7DbaDbbDbcCdcbD00D18D26Dd6De8Cc98Dd0CffeD21D31D41D51D61D71D81D91Da1Db1C889D67D68D69Dd3Cc88Dd1De1Df2C597D77D85D94CcbaD03D04D05Df3Df4Df5CfffD0fDffC664DaeDbeDceC29cD63D64D93Cb00D3aC6a2Dc9DcaCa98D0eDfeC667D7eD8e"{

	run("Calculate Ratios");

}